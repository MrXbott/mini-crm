
## Мини-CRM
Этот проект реализует систему распределения обращений клиентов из разных источников между свободными операторами.

Стэк
- Python
- FastApi
- Pydantic, pydantic-settings
- SQLite

Реализован только основной функционал:
- создание оператора (operator), обновление, просмотр всех операторов
- создание источника (source), просмотр всех источников
- создание клиента (lead), просмотр всех клиентов
- создание обращения (contact), просмотр всех обращений
- привязка оператора к работе с конкретными источниками
- назначение оператора на конкретное обращение клиента

Оператор может быть активен или нет. Каждый оператор имеет допустимую максимальную нагрузку, то есть число обращений, которые он может обрабатывать одновременно.

Под источником подразумевается условный чат на различных платформах. К источнику может быть привязано несколько операторов. Оператор, привязанный к источнику, имеет вес, который указывает процент обращений, которые должен получать оператор, от общего числа обращений.

Один и тот же клиент может написать из различных источников. У каждого клиента есть id (в данном случае email), по которому можно его идентифицировать. Подразумевается что email передается при создании обращения клиента из любого источника. Если клиент новый, то есть не найден в базе по email, то он добавляется в базу.

В момент создания обращения ему назначается оператор из числа доступных (привязанных к конкретному источнику, активных, и с загрузкой меньшей их максимальной загрузки). Если подходящего оператора нет, то обращение все равно создается со статусом 'open', чтобы можно было на него впоследствии принудительно назначить оператора.

Распределение обращений между операторами осуществляется с использованием алгоритма взвешенного случайного выбора. 

### Как запустить

Можно запустить проект следующей командой:

`poetry run uvicorn mini_crm.main:app --reload`
  




